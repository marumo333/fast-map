# Fast-Map

最適なルートを提案する地図アプリケーション

## 機能

### 実装済みの機能
- 出発地と目的地の選択
  - 地図上でのクリックによる選択
  - 現在地を出発地として設定
- ルート情報の表示
  - 距離（km）
  - 車での所要時間（分）
  - 徒歩での所要時間（分）
  - 有料道路の有無
- リアルタイムの交通情報表示
  - 30秒ごとの更新
  - 混雑度の表示
  - 遅延時間の表示
- 渋滞情報に基づくルート変更提案
  - 渋滞発生時の通知
  - 代替ルートの提案
  - 所要時間の比較表示
- フィードバック機能
  - ルート情報へのフィードバック送信

### 開発予定の機能
- 複数のルート提案（車、徒歩）
- より詳細な交通情報の表示
- 複数の交通手段のサポート
- オフライン対応
- パフォーマンスのさらなる最適化
- ユーザー設定のカスタマイズ機能

## 技術スタック

### フロントエンド
- **Next.js 14**: アプリケーションの基盤
  - React Server Components
  - App Router
  - Server Actions
- **TypeScript**: 型安全性の確保
- **Tailwind CSS**: スタイリング
- **React Hooks**: 状態管理と副作用の制御
  - useState
  - useEffect
  - useRef
  - useCallback
- **Google Maps API**: 地図表示とルート検索
- **Vercel**: デプロイとホスティング

### 開発ツール
- **ESLint**: コード品質の維持
- **Prettier**: コードフォーマット
- **TypeScript**: 型チェック
- **Git**: バージョン管理

## 実装の詳細

### 交通情報の表示
- 30秒ごとに交通情報を更新
- 混雑度、遅延時間、所要時間を表示
- 3秒後に自動的に通知を非表示
- スムーズな表示/非表示のアニメーション

### ルート変更の提案
- 渋滞発生時に代替ルートを提案
- 有料道路の有無を考慮
- 所要時間の差分を表示
- ユーザーが選択できる通知UI

### 地図表示
- インタラクティブな地図操作
- 現在地の表示
- ルートの可視化
- マーカーの表示

## 実装で苦労した点と解決手段

### 1. 交通情報の更新と表示制御
#### 課題
- リアルタイムでの交通情報の取得と表示の最適化
- 通知の表示/非表示のタイミング制御
- 型定義の整合性の維持
- 不要な再レンダリングの防止

#### 解決手段
- **React Hooks**を使用した状態管理
  - `useState`で通知の表示状態を管理
  - `useEffect`でタイマー制御
  - `useRef`で前回の情報を保持
- **TypeScript**による型定義
  - インターフェースの厳密な定義
  - 型チェックによる早期エラー発見
- **パフォーマンス最適化**
  - `useCallback`による関数のメモ化
  - 条件付きレンダリングの最適化

### 2. ルート変更の提案ロジック
#### 課題
- 渋滞情報に基づく適切なルート選択
- 有料道路の有無の考慮
- ユーザーへの分かりやすい情報提供
- 通知UIのUX改善

#### 解決手段
- **Google Maps API**の活用
  - Directions Serviceによるルート検索
  - Traffic Modelによる渋滞予測
- **Reactコンポーネント**の設計
  - 通知コンポーネントの分離
  - アニメーションの実装
- **Tailwind CSS**によるスタイリング
  - レスポンシブデザイン
  - アニメーション効果

### 3. パフォーマンスの最適化
#### 課題
- 地図の読み込み時間の短縮
- 交通情報の更新頻度の調整
- メモリリークの防止
- 不要なAPI呼び出しの削減

#### 解決手段
- **Next.js**の機能活用
  - 動的インポートによるコード分割
  - 画像の最適化
- **React**の最適化
  - メモ化による再レンダリングの制御
  - クリーンアップ関数の実装
- **API呼び出しの最適化**
  - ポーリング間隔の調整
  - キャッシュの活用

### 4. 型定義の管理
#### 課題
- 複数のコンポーネント間での型の整合性維持
- APIレスポンスの型定義
- 状態管理の型安全性確保
- 型エラーの早期発見と修正

#### 解決手段
- **TypeScript**の機能活用
  - インターフェースの定義
  - 型の継承と拡張
  - ユーティリティ型の使用
- **ESLint**と**Prettier**の設定
  - 型チェックの自動化
  - コードフォーマットの統一

## 今後の改善点

- より詳細な交通情報の表示
- 複数の交通手段のサポート
- オフライン対応
- パフォーマンスのさらなる最適化
- ユーザー設定のカスタマイズ機能

## 開発環境のセットアップ

1. リポジトリのクローン
```bash
git clone https://github.com/marumo333/fast-map.git
```

2. 依存関係のインストール
```bash
npm install
```

3. 環境変数の設定
`.env.local`ファイルを作成し、以下の変数を設定：
```
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=your_api_key
```

4. 開発サーバーの起動
```bash
npm run dev
```

## デプロイ

このアプリケーションはVercelにデプロイされています。
- 本番環境: https://fast-map.vercel.app
- ステージング環境: https://staging.fast-map.vercel.app

## ライセンス

MIT License

---

詳細な要件・仕様は [PRD.md](./PRD.md) を参照してください。
